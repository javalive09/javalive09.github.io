<html><head><title>git命令</title><meta name="keywords" content="My Blog, Spider Bitch!"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link href="/css/main.css?v=2" rel="stylesheet" type="text/css"><link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2"></head><body><h2 class="title">git命令</h2><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">git --version  </div><div class="line">git config --list</div><div class="line">git config --global user.name &quot;first name&quot;</div><div class="line">git config --global user.email &quot;javalive09@163.com&quot;  </div><div class="line">git config color.ui true </div><div class="line">git config -e //demo/.git/config</div><div class="line">git config -e --global // /home/peter/.gitconfig</div><div class="line">git config -e --system  // /etc/gitconfig</div><div class="line">ssh-keygen -t rsa -C &quot;javalive09@163.com&quot;</div><div class="line">clip &lt; ~/.ssh/id_rsa.pub</div><div class="line">ssh -T git@github.com</div></pre></td></tr></table></figure><p>配置多个仓库<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git touch ~/.ssh/config</div></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">#GitHub  </div><div class="line">Host github.com  </div><div class="line">  User git  </div><div class="line">  HostName github.com  </div><div class="line">  IdentityFile ~/.ssh/id_rsa  </div><div class="line">  </div><div class="line">#Maxthon   </div><div class="line">Host mgit    </div><div class="line">  User git      </div><div class="line">  HostName mgit.maxthon.net  </div><div class="line">  Port 22      </div><div class="line">  IdentityFile ~/.ssh/id_rsa  </div><div class="line">  </div><div class="line">#Bitbucket  </div><div class="line">Host bitbucket.org  </div><div class="line"> User git  </div><div class="line"> HostName bitbucket.org  </div><div class="line"> IdentityFile ~/.ssh/id_rsa</div></pre></td></tr></table></figure><h1 id="创建和提交"><a href="#创建和提交" class="headerlink" title="创建和提交"></a>创建和提交</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git init </div><div class="line">git add -A  //添加到缓存区</div><div class="line">git commit -m &quot;提交代码信息&quot;  // 提交代码</div><div class="line">git commit --amend // 修改提交信息</div></pre></td></tr></table></figure><h1 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">git remote -v</div><div class="line">git remote add origin https://github.com/javalive09/CodeBag.git //添加远程仓库</div><div class="line">git remote set-url origin https://github.com/javalive09/CodeBag.git //修改远程仓库url</div><div class="line">git push origin --delete &lt;branchName&gt;  //删除远程分支</div><div class="line">git push origin master //推送到远程仓库</div><div class="line">git clone https://github.com/javalive09/CodeBag.git // 从远程仓库clone</div><div class="line">git pull //从远程仓库拉取pull = fetch + merge</div></pre></td></tr></table></figure><h1 id="切换和还原"><a href="#切换和还原" class="headerlink" title="切换和还原"></a>切换和还原</h1><p>reset本质：将当前分支HEAD指针指向任意提交点<br>checkout本质：切换分支<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">git checkout develop -f //强制切换分支 （放弃本地修改切换)</div><div class="line">git checkout HEAD /Users/peter/git/xui/XuiPSdk/libs/armeabi/libgetuiext.so  //还原单个文件到HEAD</div><div class="line">git checkout abbdc /Users/peter/git/xui/XuiPSdk/libs/armeabi/libgetuiext.so  //还原单个文件到abbdc</div><div class="line">git checkout &lt;commit&gt; &lt;filepath&gt;  //还原单个文件的某个版本</div><div class="line">git checkout 45b92e3 /Users/peter/git/xui/CarClient/assets/video/video.mp4  </div><div class="line">git reset --hard master  //还原整个项目到master</div><div class="line">git reset --hard HEAD  //还原到HEAD</div><div class="line">git reset –hard HEAD^  //还原到HEAD上次提交</div></pre></td></tr></table></figure><p></p><h2 id="查看仓库状态"><a href="#查看仓库状态" class="headerlink" title="查看仓库状态"></a>查看仓库状态</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git status</div></pre></td></tr></table></figure><h2 id="查看log"><a href="#查看log" class="headerlink" title="查看log"></a>查看log</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git log  </div><div class="line">git log --graph </div><div class="line">git log --oneline</div><div class="line">git log --oneline --graph</div></pre></td></tr></table></figure><h1 id="tag-标签"><a href="#tag-标签" class="headerlink" title="tag 标签"></a>tag 标签</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">git tag   </div><div class="line">git tag -l  </div><div class="line">git show 1.0  </div><div class="line">git tag -a v1.0 -m &quot;新加tag&quot;  </div><div class="line">git tag -d v1.0  //删除本地标签</div><div class="line">git push origin --tags  </div><div class="line">git push origin :refs/tags/&lt;tag name&gt;  //删除远程tag</div></pre></td></tr></table></figure><h2 id="重命名tag"><a href="#重命名tag" class="headerlink" title="重命名tag"></a>重命名tag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git tag new old</div><div class="line">git tag -d old</div><div class="line">git push origin :refs/tags/old</div><div class="line">git push --tags</div></pre></td></tr></table></figure><h1 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">git branch  </div><div class="line">git branch abc  </div><div class="line">git checkout abc  </div><div class="line">git push origin abc  </div><div class="line">git push origin :abc //删除远程分支</div><div class="line">git checkout -b abc </div><div class="line">git branch -a   //列出所有分支（本地＋远程）</div><div class="line">git checkout -b abc  //创建并且切换分支</div><div class="line">git branch -d &lt;branch name&gt; //删除本地分支</div><div class="line">git branch -m release_v1.24 release_v1.0.0 //修改分支名字</div></pre></td></tr></table></figure><h1 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git stash </div><div class="line">git stash list</div><div class="line">git stash apply stash@&#123;2&#125;</div></pre></td></tr></table></figure><h1 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git rm --cache path   //忽略已经提交的文件</div><div class="line">git rm path  //删除版本库中的文件</div><div class="line">git mv welcome.txt README  //修改版本库中的文件名</div></pre></td></tr></table></figure><h2 id="出现-modified-idea-misc-xml-如何解决"><a href="#出现-modified-idea-misc-xml-如何解决" class="headerlink" title="出现 modified: .idea/misc.xml 如何解决"></a>出现 modified: .idea/misc.xml 如何解决</h2><p>修改ignore后输出如下命令：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git rm -rf .idea</div><div class="line">git commit -m &quot;delete .idea&quot;</div><div class="line">git push</div></pre></td></tr></table></figure><p></p><h1 id="恢复"><a href="#恢复" class="headerlink" title="恢复"></a>恢复</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git reflog show </div><div class="line">git branch recover_branch commitid</div></pre></td></tr></table></figure><h1 id="对比文件"><a href="#对比文件" class="headerlink" title="对比文件"></a>对比文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git diff //对比（工作区和上次提交）的区别</div><div class="line">git diff filename  //对比（工作区某个文件和上次提交的这个文件）的区别</div><div class="line">git diff --cached  //对比（缓存区和上次提交）的区别</div><div class="line">git diff –cached filename //对比（缓存区某个文件和上次提交的这个文件）的区别</div><div class="line">git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9 b8e7b00c02b95b320f14b625663fdecf2d63e74c   //对比（某两个版本）的区别</div><div class="line">git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9:filename b8e7b00c02b95b320f14b625663fdecf2d63e74c:filename  //对比（某两个版本文件）的区别</div></pre></td></tr></table></figure><h1 id="归档"><a href="#归档" class="headerlink" title="归档"></a>归档</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git archive -o latest.zip HEAD  //基于最新提交建立归档文件latest.zip</div><div class="line">git archive -o partial.tar HEAD src doc  //只将目录src和doc建立到归档partial.tar中</div><div class="line">git archive --format=tar --prefix=1.0/ v1.0 | gzip &gt; foo-1.0.tar.gz  //基于里程碑v1.0建立归档，并且为归档中文件添加目录前缀1.0</div></pre></td></tr></table></figure><h1 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h1><h2 id="生成path"><a href="#生成path" class="headerlink" title="生成path"></a>生成path</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git format-patch -&lt;n&gt; &lt;SHA1&gt;</div><div class="line">git format-patch -1 &lt;sha&gt;</div></pre></td></tr></table></figure><h2 id="应用patch"><a href="#应用patch" class="headerlink" title="应用patch"></a>应用patch</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git am xxx.patch</div></pre></td></tr></table></figure><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git apply --ignore-space-change --ignore-whitespace mychanges.patch</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git apply --reject --whitespace=fix mychanges.patch</div></pre></td></tr></table></figure><h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><h2 id="1-合并多次提交为一次提交"><a href="#1-合并多次提交为一次提交" class="headerlink" title="1.合并多次提交为一次提交"></a>1.合并多次提交为一次提交</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git reset —soft &lt;commitId&gt;//要合并的起始提交点id</div><div class="line">git commit -m &quot;xxx&quot;</div></pre></td></tr></table></figure><h2 id="2-剔除某次提交"><a href="#2-剔除某次提交" class="headerlink" title="2.剔除某次提交"></a>2.剔除某次提交</h2><h3 id="没有push到服务器"><a href="#没有push到服务器" class="headerlink" title="没有push到服务器"></a>没有push到服务器</h3><h4 id="方法1：cherry-pick"><a href="#方法1：cherry-pick" class="headerlink" title="方法1：cherry-pick"></a>方法1：cherry-pick</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git checkout &lt;commitId-last&gt;//要剔除提交点的上一个提交点id</div><div class="line">git cherry-pick &lt;commitId-next&gt;//要剔除提交点的下一个提交点id</div><div class="line">... //cherry-pick 其他提交点</div><div class="line">git checkout master</div><div class="line">git reset --hard &lt;commitId-end&gt;//最后一次cherry-pick的提交点</div></pre></td></tr></table></figure><h4 id="方法2：rebase-–onto-如果有冲突会打乱提交历史记录"><a href="#方法2：rebase-–onto-如果有冲突会打乱提交历史记录" class="headerlink" title="方法2：rebase –onto(如果有冲突会打乱提交历史记录)"></a>方法2：rebase –onto(如果有冲突会打乱提交历史记录)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rebase --onto &lt;newbase&gt;//要剔除提交点的上一个提交点id &lt;since&gt;//要剔除提交点的id &lt;branch&gt;</div></pre></td></tr></table></figure><h4 id="方法3：rebase-i-推荐"><a href="#方法3：rebase-i-推荐" class="headerlink" title="方法3：rebase -i //推荐"></a>方法3：rebase -i //推荐</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git rebase -i &lt;commitId-last&gt; </div><div class="line">修改vim中弹出的信息，把要删除的 commitId 的pick 修改成 d 保存后退出</div></pre></td></tr></table></figure><h3 id="push到服务器"><a href="#push到服务器" class="headerlink" title="push到服务器"></a>push到服务器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git revert &lt;commitId&gt;</div></pre></td></tr></table></figure><h2 id="3-修改提交信息"><a href="#3-修改提交信息" class="headerlink" title="3.修改提交信息"></a>3.修改提交信息</h2><h3 id="修改最近一条消息"><a href="#修改最近一条消息" class="headerlink" title="修改最近一条消息"></a>修改最近一条消息</h3><h4 id="没有push到服务器-1"><a href="#没有push到服务器-1" class="headerlink" title="没有push到服务器"></a>没有push到服务器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit --amend</div></pre></td></tr></table></figure><h4 id="push到服务器-1"><a href="#push到服务器-1" class="headerlink" title="push到服务器"></a>push到服务器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git commit --amend</div><div class="line">git push -f origin master</div></pre></td></tr></table></figure><h3 id="修改以前的消息"><a href="#修改以前的消息" class="headerlink" title="修改以前的消息"></a>修改以前的消息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rebase -i &lt;commitId-last&gt;</div></pre></td></tr></table></figure><p>修改vim中弹出的信息，把pick 修改成 r 保存后退出<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push -f origin master</div></pre></td></tr></table></figure><p></p><h1 id="submodule"><a href="#submodule" class="headerlink" title="submodule"></a>submodule</h1><h2 id="add"><a href="#add" class="headerlink" title="add"></a>add</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">git submodule add git@git.raventech.cn:H1S/common-proto.git /support/src/main/common-proto</div><div class="line"></div><div class="line">git status//检测添加成功</div><div class="line"></div><div class="line">    On branch master</div><div class="line">    Changes to be committed:    </div><div class="line">        new file:   .gitmodules</div><div class="line">        new file:   common-proto</div><div class="line">    表示添加成功</div></pre></td></tr></table></figure><h2 id="modify"><a href="#modify" class="headerlink" title="modify"></a>modify</h2><p>在submodule目录下可以进行所有的git子项目操作<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git add</div><div class="line">git commit -m &quot;abc&quot;</div><div class="line">git push</div></pre></td></tr></table></figure><p></p><h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git submodule foreach git pull//项目根目录下</div><div class="line">或</div><div class="line">git pull//子项目目录下</div></pre></td></tr></table></figure><h2 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git clone git@git.raventech.cn:H1S/common-proto.git --recursive</div><div class="line">或</div><div class="line">git submodule init</div><div class="line">git submodule update</div></pre></td></tr></table></figure><h2 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">1.</div><div class="line">git rm --cached common-proto</div><div class="line">rm -rf common-proto</div><div class="line">rm .gitmodules</div><div class="line"></div><div class="line">2.</div><div class="line">vim .git/config //update config</div><div class="line"></div><div class="line">3.</div><div class="line">git commit -a -m &apos;remove common-proto submodule&apos;</div><div class="line">git push</div></pre></td></tr></table></figure><h1 id="subtree"><a href="#subtree" class="headerlink" title="subtree"></a>subtree</h1><p>假设，你要在各个项目里的/support/src/main/common-proto这个目录对 git@git.raventech.cn:H1S/common-proto.git这个项目做Subtree</p><ol><li><p>add remote</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote add proto git@git.raventech.cn:H1S/common-proto.git</div></pre></td></tr></table></figure></li><li><p>add subtree</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd 项目的路径  </div><div class="line">git subtree add --prefix=用来放proto项目的相对路径 proto项目git地址 xxx分支  </div><div class="line"></div><div class="line">git subtree add --prefix=/support/src/main/common-proto proto master</div></pre></td></tr></table></figure></li><li><p>update</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git subtree pull --prefix=/support/src/main/common-proto proto master</div></pre></td></tr></table></figure></li><li><p>push subtree commit</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git subtree push --prefix=/support/src/main/common-proto proto hotfix/proto</div><div class="line"></div><div class="line">在common-proto项目中合并hotfix/proto即可</div></pre></td></tr></table></figure></li></ol><h1 id="速查表"><a href="#速查表" class="headerlink" title="速查表"></a><a href="https://git-scm.com/docs" target="_blank" rel="external">速查表</a></h1><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="undefined";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><div style="display:none"><script src="http://s4.cnzz.com/stat.php?id=undefined&web_id=undefined" language="JavaScript"></script>script></div></body></html>