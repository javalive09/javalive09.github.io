<!doctype html><html class="theme-next pisces" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="Hexo, NexT"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="description" content="URI（uniformresource identifier）和URL（universal resource Loactor）的区别一个URI定义了一种资源，它是一个定位符。一个URI由两部分组成： scheme （URI协议名）：scheme-specific-part（URI协议对应的内容）一个URL由三部分组成：scheme（协议）：// 主机IP地址 / 资源具体地址一个URI是一个URL"><meta property="og:type" content="article"><meta property="og:title" content="网络"><meta property="og:url" content="http://yoursite.com/2017/02/11/网络/index.html"><meta property="og:site_name" content="200code"><meta property="og:description" content="URI（uniformresource identifier）和URL（universal resource Loactor）的区别一个URI定义了一种资源，它是一个定位符。一个URI由两部分组成： scheme （URI协议名）：scheme-specific-part（URI协议对应的内容）一个URL由三部分组成：scheme（协议）：// 主机IP地址 / 资源具体地址一个URI是一个URL"><meta property="og:updated_time" content="2017-02-13T13:12:45.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="网络"><meta name="twitter:description" content="URI（uniformresource identifier）和URL（universal resource Loactor）的区别一个URI定义了一种资源，它是一个定位符。一个URI由两部分组成： scheme （URI协议名）：scheme-specific-part（URI协议对应的内容）一个URL由三部分组成：scheme（协议）：// 主机IP地址 / 资源具体地址一个URI是一个URL"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",sidebar:{position:"left",display:"always"},fancybox:!1,motion:!1,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2017/02/11/网络/"><title>网络 | 200code</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?afd325d3333e718fc607b569c45d57a4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">200code</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/11/网络/"><span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="peter"><meta itemprop="description" content=""><meta itemprop="image" content="http://7xoxmg.com1.z0.glb.clouddn.com/avatar.jpg"></span><span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="200code"><span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject"><img style="display:none" itemprop="url image" alt="200code" src=""></span></span><header class="post-header"><h1 class="post-title" itemprop="name headline">网络</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-11T08:52:34+08:00">2017-02-11 </time></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/02/11/网络/#comments" itemprop="discussionUrl"><span class="post-comments-count ds-thread-count" data-thread-key="2017/02/11/网络/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="URI（uniformresource-identifier）和URL（universal-resource-Loactor）的区别"><a href="#URI（uniformresource-identifier）和URL（universal-resource-Loactor）的区别" class="headerlink" title="URI（uniformresource identifier）和URL（universal resource Loactor）的区别"></a>URI（uniformresource identifier）和URL（universal resource Loactor）的区别</h1><p>一个URI定义了一种资源，它是一个定位符。<br>一个URI由两部分组成： scheme （URI协议名）：scheme-specific-part（URI协议对应的内容）<br>一个URL由三部分组成：scheme（协议）：// 主机IP地址 / 资源具体地址<br>一个URI是一个URL或URN<br>URL、URN是URI的子集<br>当对某种资源是URL还是URI产生疑惑时，用URI来定义它</p><hr><h1 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h1><p>超文本传输协议，用于网络间传输数据。传输的内容不仅是文本文字，还有图片，程序包，文件等各种格式的数据。<br>HTTP是一个应用层协议，由请求和响应构成，是一个标准的客户端服务器模型。HTTP是一个无状态的协议。</p><h2 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h2><p>请求行（负责请求的方式），消息头（负责请求的协议），正文（负责请求的内容）</p><h2 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h2><p>状态行（负责响应的状态提示），消息头（负责相应的协议），正文（负责响应的内容）</p><h3 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h3><p>1XX 提示消息（成功接收，继续处理）<br>2XX 成功<br>3XX 重定向<br>4XX 客户端错误（url 资源错误）<br>5XX 服务器端错误（服务端没实现此功能）</p><h1 id="OSI网络模型"><a href="#OSI网络模型" class="headerlink" title="OSI网络模型"></a>OSI网络模型</h1><p>7层，应用程（经理）：负责写草稿 / 阅读信件 ————— 内容提供或阅读内容<br>6层，表示层（助理）：负责将草稿写成正规格式的信 / 翻译信的内容 —————加解密<br>5层，会话层（秘书）：负责写好信封（收信人地址） / 打开信件 —————建立通讯<br>4层，传输层（司机）：将信带到邮局 / 从邮局拿回信 —————确保数据传输</p><p>3层，网络层（排序工人）： 将信件根据收件地址分类 / 整理分类出信件 —————将发送方的数据传到接收方，路由器<br>2层，数据链路层（包装工人）：将信件包装 / 打开包装 —————管理比特数据，交换机<br>1层，物理层（搬运工人）： 将信件装上车 / 将信件卸下车 —————物理设备，传输高低电压，如电缆</p><hr><h1 id="tcp连接-为什么要进行3次握手，断开为什么要4次握手"><a href="#tcp连接-为什么要进行3次握手，断开为什么要4次握手" class="headerlink" title="tcp连接 为什么要进行3次握手，断开为什么要4次握手"></a>tcp连接 为什么要进行3次握手，断开为什么要4次握手</h1><h2 id="建立连接"><a href="#建立连接" class="headerlink" title="建立连接"></a>建立连接</h2><ul><li>A打电话给B，需要询问，你是B么？</li><li>B回答说我是B。</li><li>A堆B说，我找的就是你。<br>至此，A知道找对了B。B也知道A是要找他。<blockquote><p>如果不是3次握手的话，如果是客户端A和服务器B连接的话，A请求连接，B分配资源并回复的话，有可能会是A是误请求，这样容易造成资源浪费。<br>早期网络连接不稳定，引起路由寻址的问题，经常会连接出错，所以加了一次需要客户端A确认的操作。</p></blockquote></li></ul><p>相当于打电话时网络运营商连接了错的号码。<br>双方确定连接。<br>之后开始正式的传输数据。</p><h3 id="断开连接"><a href="#断开连接" class="headerlink" title="断开连接"></a>断开连接</h3><ul><li>A告诉B，我要说的说完了，我要挂电话了。</li><li>B告诉A， 好的。</li><li>B告诉A，我要说的也说完了，我也要挂电话了。</li><li>A告诉B，好的。<br>双方确定彼此都要挂断电话后，正式断开连接。<h2 id="什么是MIME"><a href="#什么是MIME" class="headerlink" title="什么是MIME"></a>什么是MIME</h2>用于标记传输的数据的文件类型。<br>最早应用于电子邮件系统，但后来也应用到浏览器，以及所有的cs 交互模型中。在HTTP协议中用Content-type描述。<br>MIME(Multipurpose Internet Mail Extensions)<br>多用途互联网邮件扩展类型，是一个互联网标准，标准定义在 <a href="http://www.cnpaf.net/class/rfcall/" target="_blank" rel="external">RFC</a> 文档中。<br>http post提交表单格式数据 content-type ：application/x-www-form-urlencoded<br>http post提交json格式数据 content-type ：application/json</li></ul><hr><h1 id="UDP协议"><a href="#UDP协议" class="headerlink" title="UDP协议"></a>UDP协议</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>UDP: User Datagram Protocol 用户数据报协议 是一种无连接的协议。UDP有不提供数据包分组、组装和不能对数据包进行排序的缺点，也就是说，当报文发送之后，是无法得知其是否安全完整到达的。UDP用来支持那些需要在计算机之间传输数据的网络应用。包括网络视频会议系统在内的众多的客户/服务器模式的网络应用都需要使用UDP协议。<a href="http://colobu.com/2014/10/21/udp-and-unicast-multicast-broadcast-anycast/" target="_blank" rel="external">参考</a> <a href="https://github.com/netty/netty/tree/4.0/example/src/main/java/io/netty/example/qotm" target="_blank" rel="external">Netty UDP 官方 demo</a></p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>在选择使用协议的时候，选择UDP必须要谨慎。在网络质量令人十分不满意的环境下，UDP协议数据包丢失会比较严重。但是由于UDP的特性：它不属于连接型协议，因而具有资源消耗小，处理速度快的优点，所以通常音频、视频和普通数据在传送时使用UDP较多。<br>UDP广播：广播使用广播地址255.255.255.255，将消息发送到在同一广播网络上的每个主机。值得强调的是：本地广播信息是不会被路由器转发。当然这是十分容易理解的，因为如果路由器转发了广播信息，那么势必会引起网络瘫痪。这也是为什么IP协议的设计者故意没有定义互联网范围的广播机制。其实广播顾名思义，就是想局域网内所有的人说话，但是广播还是要指明接收者的端口号的，因为不可能接受者的所有端口都来收听广播。</p><h2 id="UDP广播"><a href="#UDP广播" class="headerlink" title="UDP广播"></a>UDP广播</h2><p>广播使用广播地址255.255.255.255，将消息发送到在同一广播网络上的每个主机。值得强调的是：本地广播信息是不会被路由器转发。当然这是十分容易理解的，因为如果路由器转发了广播信息，那么势必会引起网络瘫痪。这也是为什么IP协议的设计者故意没有定义互联网范围的广播机制。其实广播顾名思义，就是想局域网内所有的人说话，但是广播还是要指明接收者的端口号的，因为不可能接受者的所有端口都来收听广播。</p><h3 id="发送接收代码"><a href="#发送接收代码" class="headerlink" title="发送接收代码"></a>发送接收代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">public static void sendBroadcast(byte[] data, int port) throws Exception&#123;</div><div class="line">    DatagramSocket socket = new DatagramSocket();</div><div class="line">    socket.setBroadcast(true);</div><div class="line">    DatagramPacket packet = new DatagramPacket(data, data.length, InetAddress.getByName(&quot;255.255.255.255&quot;), port);</div><div class="line">    socket.send(packet);</div><div class="line">&#125;</div><div class="line"></div><div class="line">public static void receiveBoradcast(int port) &#123;</div><div class="line">    new Thread(new Runnable() &#123;</div><div class="line"></div><div class="line">        DatagramSocket socket;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            while (true) &#123;</div><div class="line">                try &#123;</div><div class="line">                    receive(port);</div><div class="line">                &#125; catch (Exception e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void receive(int port) throws Exception&#123;</div><div class="line">            if (socket == null || socket.isClosed()) &#123;</div><div class="line">                socket = new DatagramSocket(port);</div><div class="line">                socket.setBroadcast(true);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            byte[] buffer = new byte[1024 * 100];</div><div class="line">            DatagramPacket packet = new DatagramPacket(buffer , buffer.length);</div><div class="line">            socket.receive(packet);</div><div class="line">            String data = new String(packet.getData(), 0, packet.getLength());</div><div class="line">            Log.i(&quot;receiver&quot;, data);</div><div class="line">            socket.close();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;).start();</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Netty-实现代码"><a href="#Netty-实现代码" class="headerlink" title="Netty 实现代码"></a>Netty 实现代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">public class Broadcast &#123;</div><div class="line"></div><div class="line">    Channel udpChannel;</div><div class="line"></div><div class="line">    public void send(String data) throws Exception&#123;</div><div class="line">        if(udpChannel != null) &#123;</div><div class="line">            udpChannel.writeAndFlush(data);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void init(int port) &#123;</div><div class="line">        NioEventLoopGroup group = new NioEventLoopGroup();</div><div class="line">        Bootstrap bootstrap = new Bootstrap();</div><div class="line">        bootstrap.group(group)</div><div class="line">                .channel(NioDatagramChannel.class)</div><div class="line">                .option(ChannelOption.SO_BROADCAST, true)</div><div class="line">                .handler(new MessageToMessageEncoder&lt;String&gt;() &#123;</div><div class="line">                    @Override</div><div class="line">                    protected void encode(ChannelHandlerContext ctx, String msg, List&lt;Object&gt; out) throws Exception &#123;</div><div class="line">                        InetSocketAddress remoteAddress = new InetSocketAddress(&quot;255.255.255.255&quot;, port);</div><div class="line">                        out.add(new DatagramPacket(Unpooled.copiedBuffer(msg, CharsetUtil.UTF_8), remoteAddress));</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">        udpChannel = bootstrap.bind(0).syncUninterruptibly().channel();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">public class BroadcastReceiver &#123;</div><div class="line"></div><div class="line">    public void start(int port)&#123;</div><div class="line">        Bootstrap b = new Bootstrap();</div><div class="line">        NioEventLoopGroup group = new NioEventLoopGroup();</div><div class="line">        try &#123;</div><div class="line">            b.group(group)</div><div class="line">                    .channel(NioDatagramChannel.class)</div><div class="line">                    .option(ChannelOption.SO_BROADCAST, true)</div><div class="line">                    .handler(new SimpleChannelInboundHandler&lt;DatagramPacket&gt;() &#123;</div><div class="line"></div><div class="line">                        @Override</div><div class="line">                        protected void messageReceived(ChannelHandlerContext ctx, DatagramPacket packet) throws Exception &#123;</div><div class="line">                            String req = packet.content().toString(CharsetUtil.UTF_8);</div><div class="line">                            System.out.println(req);</div><div class="line">                        &#125;</div><div class="line">                    &#125;);</div><div class="line">            b.bind(port).sync().channel().closeFuture().await();</div><div class="line">        &#125;catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;finally &#123;</div><div class="line">            group.shutdownGracefully();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="UDP多播"><a href="#UDP多播" class="headerlink" title="UDP多播"></a>UDP多播</h2><p>多播数据报套接字类用于发送和接收 IP 多播包。MulticastSocket 是一种 (UDP) DatagramSocket，它具有加入 Internet 上其他多播主机的“组”的附加功能。<br>多播组通过 D 类 IP 地址和标准 UDP 端口号指定。D 类 IP 地址在 224.0.0.0 和 239.255.255.255 的范围内（包括两者）。地址 224.0.0.0 被保留，不应使用。</p><h3 id="多播代码"><a href="#多播代码" class="headerlink" title="多播代码"></a>多播代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">public class MultiBroadcast &#123;</div><div class="line"></div><div class="line">    public void startReveive(String host, int port) &#123;</div><div class="line"></div><div class="line">        new Thread(new Runnable() &#123;</div><div class="line"></div><div class="line">            MulticastSocket ms;</div><div class="line"></div><div class="line">            private void receive(String host, int port) throws Exception&#123;</div><div class="line">                byte[] buf = new byte[1024 * 100];</div><div class="line">                if(ms == null || ms.isClosed()) &#123;</div><div class="line">                    ms = new MulticastSocket(port);</div><div class="line">                    DatagramPacket dp = new DatagramPacket(buf, buf.length);</div><div class="line">                    InetAddress group = InetAddress.getByName(host);</div><div class="line">                    ms.joinGroup(group);</div><div class="line">                    ms.receive(dp);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                Log.i(&quot;receiver&quot;, new String(buf));</div><div class="line">                ms.close();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void run() &#123;</div><div class="line">                while (true) &#123;</div><div class="line">                    try &#123;</div><div class="line">                        receive(host, port);</div><div class="line">                        Thread.sleep(100);</div><div class="line">                    &#125; catch (Exception e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;).start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void send(String host, int port, String message) throws Exception&#123;</div><div class="line">        InetAddress group = InetAddress.getByName(host);</div><div class="line">        MulticastSocket s = new MulticastSocket();</div><div class="line">        s.joinGroup(group);</div><div class="line">        DatagramPacket dp = new DatagramPacket(message.getBytes(),message.length(), group,port);</div><div class="line">        s.send(dp);</div><div class="line">        s.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="UDP单播"><a href="#UDP单播" class="headerlink" title="UDP单播"></a>UDP单播</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">public class UnicastBroadcast &#123;</div><div class="line"></div><div class="line">    public void send(String host, int port, byte[] message) throws Exception&#123;</div><div class="line">        //sending data to host and its port</div><div class="line">        InetAddress address = InetAddress.getByName(host);</div><div class="line">        // Initialize a datagram packet with data and address</div><div class="line">        DatagramPacket packet = new DatagramPacket(message, message.length, address, port);</div><div class="line">        // Create a datagram socket, send the packet through it, close it.</div><div class="line">        DatagramSocket dsocket = new DatagramSocket();</div><div class="line">        dsocket.send(packet);</div><div class="line">        dsocket.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void startReceive() &#123;</div><div class="line">        new Thread(new Runnable() &#123;</div><div class="line"></div><div class="line">            DatagramSocket dsocket;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void run() &#123;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            private void receive(int port) throws Exception&#123;</div><div class="line"></div><div class="line">                byte[] buffer = new byte[2048];</div><div class="line">                if(dsocket == null || dsocket.isClosed()) &#123;</div><div class="line">                    //receiving data from its port</div><div class="line">                    dsocket = new DatagramSocket(port);</div><div class="line">                    // Create a buffer to read datagrams into. If a</div><div class="line">                    // packet is larger than this buffer, the</div><div class="line">                    // excess will simply be discarded!</div><div class="line"></div><div class="line">                    // Create a packet to receive data into the buffer</div><div class="line">                    DatagramPacket packet = new DatagramPacket(buffer, buffer.length);</div><div class="line"></div><div class="line">                    // Wait to receive a datagram</div><div class="line">                    dsocket.receive(packet);</div><div class="line">                    // Convert the contents to a string, and display them</div><div class="line">                    String msg = new String(buffer);</div><div class="line">                    System.out.println(packet.getAddress().getHostName() + &quot;: &quot; + msg);</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                dsocket.close();</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;).start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="url编码问题"><a href="#url编码问题" class="headerlink" title="url编码问题"></a>url编码问题</h1><p>url 标准为美国制定，只支持asc编码，所以</p><ol><li>get 请求等需要传递汉子等非asc编码支持的字符时，违背的这个标准，需要url encode</li><li>参数包含&amp; = 等这些标准连接的特殊符号时，也需要url encode</li></ol><h1 id="http（android-api）"><a href="#http（android-api）" class="headerlink" title="http（android api）"></a>http（android api）</h1><p>HttpURLConnection <a href="http://stackoverflow.com/questions/2793150/using-java-net-urlconnection-to-fire-and-handle-http-requests/2793153#2793153" target="_blank" rel="external">代码demo</a></p><h2 id="发送："><a href="#发送：" class="headerlink" title="发送："></a>发送：</h2><h3 id="1-设置协议："><a href="#1-设置协议：" class="headerlink" title="1.设置协议："></a>1.设置协议：</h3><p>con.setRequestMethod(“post”), timeout 等。</p><h3 id="2-发送内容："><a href="#2-发送内容：" class="headerlink" title="2.发送内容："></a>2.发送内容：</h3><p>os = con.getOutPutStream()。<br>os.writeBytes(json data 数据).toString()</p><h3 id="3-发送流结构："><a href="#3-发送流结构：" class="headerlink" title="3.发送流结构："></a>3.发送流结构：</h3><p>请求行（自动）<br>消息头（协议）<br>内容（数据）</p><h2 id="接收："><a href="#接收：" class="headerlink" title="接收："></a>接收：</h2><p>1.con.getInputStream();<br>read();<br>2.接收流结构<br>状态行（状态码）<br>消息头（协议）<br>内容（数据）</p><blockquote><p>注：https<br>在上面的设置协议中加入：</p><ol><li>setHostnameVerifier( );<br>2.构造器中加入 setDefaultSSLSocketFactory</li></ol></blockquote><h1 id="http（apache-api）"><a href="#http（apache-api）" class="headerlink" title="http（apache api）"></a>http（apache api）</h1><h2 id="post发送："><a href="#post发送：" class="headerlink" title="post发送："></a>post发送：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.pos = new HttpPost（url）</div><div class="line">2.pos.setHeader()   协议</div><div class="line">3.pos.setEntity（） json数据</div><div class="line">4.re = new HttpClient（）.execute（pos）</div><div class="line">5.EntityUtils.toString(re.getEntity（）)</div></pre></td></tr></table></figure><h2 id="get发送："><a href="#get发送：" class="headerlink" title="get发送："></a>get发送：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.get = new HttpGet（url）</div><div class="line">2.get.setHeader()</div><div class="line">3.re = new HttpClient().execute(get)</div><div class="line">4. status = re.getStatusline().getStatusCode()</div><div class="line">re.getEntity().getContent().</div></pre></td></tr></table></figure></div><div></div><div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/02/10/命令行/" rel="next" title="命令行"><i class="fa fa-chevron-left"></i> 命令行</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/02/11/框架/" rel="prev" title="框架">框架 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"><div class="ds-share flat" data-thread-key="2017/02/11/网络/" data-title="网络" data-content="" data-url="http://yoursite.com/2017/02/11/网络/"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li><li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li><li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li><li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li><li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div></div></div></div><div class="comments" id="comments"><div class="ds-thread" data-thread-key="2017/02/11/网络/" data-title="网络" data-url="http://yoursite.com/2017/02/11/网络/"></div></div><div class="ds-thread" data-thread-key="<%- page.path %>" data-title="<%- page.title %>" data-url="<%- page.permalink %>"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="http://7xoxmg.com1.z0.glb.clouddn.com/avatar.jpg" alt="peter"><p class="site-author-name" itemprop="name">peter</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/"><span class="site-state-item-count">23</span> <span class="site-state-item-name">日志</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/javalive09" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="http://stackoverflow.com/users/4674672/peter-zhang" target="_blank" title="Stack Overflow"><i class="fa fa-fw fa-stack-overflow"></i> Stack Overflow</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#URI（uniformresource-identifier）和URL（universal-resource-Loactor）的区别"><span class="nav-number">1.</span> <span class="nav-text">URI（uniformresource identifier）和URL（universal resource Loactor）的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP协议"><span class="nav-number">2.</span> <span class="nav-text">HTTP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#请求"><span class="nav-number">2.1.</span> <span class="nav-text">请求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#响应"><span class="nav-number">2.2.</span> <span class="nav-text">响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#状态码"><span class="nav-number">2.2.1.</span> <span class="nav-text">状态码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OSI网络模型"><span class="nav-number">3.</span> <span class="nav-text">OSI网络模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#tcp连接-为什么要进行3次握手，断开为什么要4次握手"><span class="nav-number">4.</span> <span class="nav-text">tcp连接 为什么要进行3次握手，断开为什么要4次握手</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#建立连接"><span class="nav-number">4.1.</span> <span class="nav-text">建立连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#断开连接"><span class="nav-number">4.1.1.</span> <span class="nav-text">断开连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是MIME"><span class="nav-number">4.2.</span> <span class="nav-text">什么是MIME</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UDP协议"><span class="nav-number">5.</span> <span class="nav-text">UDP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念"><span class="nav-number">5.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用"><span class="nav-number">5.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDP广播"><span class="nav-number">5.3.</span> <span class="nav-text">UDP广播</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#发送接收代码"><span class="nav-number">5.3.1.</span> <span class="nav-text">发送接收代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Netty-实现代码"><span class="nav-number">5.3.2.</span> <span class="nav-text">Netty 实现代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDP多播"><span class="nav-number">5.4.</span> <span class="nav-text">UDP多播</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#多播代码"><span class="nav-number">5.4.1.</span> <span class="nav-text">多播代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDP单播"><span class="nav-number">5.5.</span> <span class="nav-text">UDP单播</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#url编码问题"><span class="nav-number">6.</span> <span class="nav-text">url编码问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#http（android-api）"><span class="nav-number">7.</span> <span class="nav-text">http（android api）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#发送："><span class="nav-number">7.1.</span> <span class="nav-text">发送：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-设置协议："><span class="nav-number">7.1.1.</span> <span class="nav-text">1.设置协议：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-发送内容："><span class="nav-number">7.1.2.</span> <span class="nav-text">2.发送内容：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-发送流结构："><span class="nav-number">7.1.3.</span> <span class="nav-text">3.发送流结构：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#接收："><span class="nav-number">7.2.</span> <span class="nav-text">接收：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#http（apache-api）"><span class="nav-number">8.</span> <span class="nav-text">http（apache api）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#post发送："><span class="nav-number">8.1.</span> <span class="nav-text">post发送：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#get发送："><span class="nav-number">8.2.</span> <span class="nav-text">get发送：</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">peter</span></div><div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">var duoshuoQuery={short_name:"200code"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.id="duoshuo-script",t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script><script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script><script src="/js/src/hook-duoshuo.js"></script></body></html>